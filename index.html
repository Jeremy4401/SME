<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SME</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* GLOBAL + THEME */
@font-face { font-family:"Comic Sans MS"; src:local("Comic Sans MS"); }
:root {
  --bg:#0f0f0f; --bg2:#1a1a1a; --text:#fff; --accent:#4caf50;
  --sidebar-bg:#0b0b0b; --sidebar-width:60px; --sidebar-expanded:220px;
}
body.light { --bg:#f8f8f8; --bg2:#e3e3e3; --text:#111; --sidebar-bg:#ccc; }
body {
  margin:0; font-family:"Comic Sans MS"; background:var(--bg); color:var(--text);
}

/* ANIMATED BACKGROUND (Gradient Waves) */
body::before {
  content:""; position:fixed; inset:0; z-index:-10;
  background:linear-gradient(135deg,#2a0845,#6441a5,#ff0080);
  background-size:300% 300%; animation:bgWaves 14s ease infinite;
}
@keyframes bgWaves {
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

/* SIDEBAR */
#sidebar {
  position:fixed; left:0; top:0; height:100%;
  width:var(--sidebar-width); background:var(--sidebar-bg);
  overflow:hidden; transition:.25s; z-index:9999;
}
#sidebar:hover { width:var(--sidebar-expanded); }
.sidebar-item {
  padding:18px; cursor:pointer; display:flex; gap:14px; align-items:center;
  white-space:nowrap; transition:.25s;
}
.sidebar-item:hover { background:#ffffff22; transform:translateX(5px); }

/* MAIN */
#main { margin-left:var(--sidebar-width); transition:.25s; padding:20px; }
#sidebar:hover ~ #main { margin-left:var(--sidebar-expanded); }
#search {
  padding:10px; width:260px; border-radius:10px; border:none;
  background:var(--bg2); color:var(--text); margin-bottom:15px;
}

/* PROFILE PANEL */
#profile-box {
  background:var(--bg2); padding:15px; border-radius:14px;
  width:300px; box-shadow:0 0 10px #0005; margin-bottom:20px;
}
#avatar-preview {
  width:90px; height:90px; border-radius:50%; border:3px solid var(--accent);
  object-fit:cover; margin-bottom:10px;
}
#profile-box input, #profile-box textarea {
  width:100%; padding:8px; border-radius:8px; border:none; background:#222; color:white;
}
#save-profile {
  width:100%; padding:10px; margin-top:8px; background:var(--accent);
  border:none; border-radius:8px; cursor:pointer; color:white; font-size:16px;
}

/* CATEGORY TABS */
#cat-tabs { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
.cat-btn {
  padding:8px 14px; background:var(--bg2); border-radius:10px;
  cursor:pointer; transition:.2s;
}
.cat-btn:hover { background:#333; }
.cat-btn.active { background:var(--accent); }

/* GAME CARDS */
.row {
  display:flex; gap:16px; overflow-x:auto; padding-bottom:15px;
}
.card {
  width:170px; background:var(--bg2); padding:12px; border-radius:14px;
  display:flex; flex-direction:column; align-items:center; cursor:pointer;
  position:relative; transition:.2s; box-shadow:0 0 10px #0005;
}
.card:hover { transform:translateY(-6px) scale(1.05); }
.card img {
  width:150px; height:110px; border-radius:12px; object-fit:cover;
}
.card button {
  width:150px; margin-top:10px; padding:9px; background:var(--accent);
  border:none; border-radius:8px; color:white; cursor:pointer;
}
.card button:hover { background:#5fd86a; }

/* FAVORITE STAR */
.fav-star {
  position:absolute; top:8px; left:8px; font-size:20px; cursor:pointer;
  color:#ffffffaa; transition:.2s;
}
.fav-star.active { color:gold; text-shadow:0 0 10px gold; }

/* MOBILE GRID */
@media(max-width:650px){
  .row { display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); overflow:visible; }
}

/* EMBED VIEWER */
#embed-container {
  position:fixed; inset:0; background:#000d; backdrop-filter:blur(8px);
  display:none; z-index:999999;
}
#embed-frame { width:100%; height:100%; border:none; }
#spinner {
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
  font-size:26px; color:white;
}
</style>
</head>
<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <div class="sidebar-item" onclick="showProfile()">üë§ Profile</div>
  <div class="sidebar-item" onclick="scrollToSection('games')">üéÆ Games</div>
  <div class="sidebar-item" onclick="scrollToSection('downloads')">‚¨á Downloads</div>
  <div class="sidebar-item" onclick="scrollToSection('favorites')">‚≠ê Favorites</div>
  <div class="sidebar-item" onclick="toggleTheme()">üåó Theme</div>
  <div class="sidebar-item" onclick="panic()">‚ö† Panic</div>
</div>

<!-- MAIN -->
<div id="main">

<input id="search" placeholder="Search..." />

<!-- PROFILE BOX -->
<div id="profile-box" style="display:none;">
  <img id="avatar-preview" src="https://i.imgur.com/1X5Rz.png">
  <input id="username" placeholder="Username">
  <textarea id="bio" placeholder="Bio..."></textarea>
  <button id="save-profile" onclick="saveProfile()">Save</button>
</div>

<!-- DOWNLOADS -->
<h1 id="downloads">Downloads</h1>
<div class="row" id="download-row"></div>

<!-- FAVORITES -->
<h1 id="favorites">Favorites</h1>
<div class="row" id="fav-row"></div>

<!-- GAMES -->
<h1 id="games">Games</h1>
<div id="cat-tabs"></div>
<div class="row" id="game-row"></div>

</div>

<!-- EMBED VIEWER -->
<div id="embed-container">
  <div id="spinner">Loading...</div>
  <iframe id="embed-frame"></iframe>
</div>

<script>
/* --- UV ENCODER --- */
const uvHost="https://holyubofficial.net/service/";
const uvEncode=u=>uvHost+btoa(u).replace(/=/g,"");

/* --- DATA --- */
const downloads=[
  {name:"Minecraft",img:"thumbnails/minecraft.png",link:"https://drive.google.com/uc?export=download&id=1lQnwB_6FZ-wPXQPg3NxcBTEVJRFxY00u"},
  {name:"Slope",img:"thumbnails/slope.png",link:"https://drive.google.com/uc?export=download&id=1IS41Lxh7Yuu4QZh7AcyhUGng_PuhwiEP"},
  {name:"Subway Surfers",img:"thumbnails/subawysurfers.png",link:"https://drive.google.com/uc?export=download&id=10UUI0JaXaQk5eKckAz_-o74s0aVdiL0J"}
];

let games=[
  {name:"Slime Rancher",img:"thumbnails/slimerancher.png",url:"https://jeremy4401.github.io/slime-rancher/",cat:"Action"},
  {name:"Minecraft Classic",img:"thumbnails/minecraft.png",url:"https://classic.minecraft.net/",cat:"Survival"},
  {name:"Buckshot Roulette",img:"thumbnails/buckshotroulette.png",url:"https://cdn.jsdelivr.net/gh/genizy/web-port@main/buckshot-roulette/index.html",cat:"Horror"},
  {name:"Theater",img:"thumbnails/theater.png",url:"https://jeremy4401.github.io/SME-Theater",cat:"Other"},
  {name:"Proxies",img:"thumbnails/proxy.png",url:"https://jeremy4401.github.io/Proxies",cat:"Tools"}
];

let favorites=JSON.parse(localStorage.getItem("favorites")||"[]");
let profile=JSON.parse(localStorage.getItem("profile")||"{}");

/* --- PROFILE --- */
function showProfile(){
  document.getElementById("profile-box").style.display=
    document.getElementById("profile-box").style.display==="none"?"block":"none";
}
function saveProfile(){
  profile={
    username:document.getElementById("username").value,
    bio:document.getElementById("bio").value
  };
  localStorage.setItem("profile",JSON.stringify(profile));
  alert("Saved!");
}

/* --- LOAD CARDS --- */
function loadDownloads(){
  const d=document.getElementById("download-row");
  downloads.forEach(x=>d.innerHTML+=`
    <div class="card">
      <img src="${x.img}">
      <a href="${x.link}"><button>${x.name}</button></a>
    </div>
  `);
}

function isFav(name){ return favorites.includes(name); }
function toggleFav(name){
  if(isFav(name)) favorites=favorites.filter(x=>x!==name);
  else favorites.push(name);
  localStorage.setItem("favorites",JSON.stringify(favorites));
  loadGames();
  loadFavorites();
}

function loadGames(){
  const g=document.getElementById("game-row");
  g.innerHTML="";
  games.forEach(x=>{
    g.innerHTML+=`
      <div class="card">
        <div class="fav-star ${isFav(x.name)?"active":""}" onclick="event.stopPropagation();toggleFav('${x.name}')">‚òÖ</div>
        <img src="${x.img}">
        <button onclick="openEmbed('${uvEncode(x.url)}')">${x.name}</button>
      </div>
    `;
  });
}

function loadFavorites(){
  const f=document.getElementById("fav-row");
  f.innerHTML="";
  games.filter(g=>isFav(g.name)).forEach(x=>{
    f.innerHTML+=`
      <div class="card">
        <div class="fav-star active" onclick="event.stopPropagation();toggleFav('${x.name}')">‚òÖ</div>
        <img src="${x.img}">
        <button onclick="openEmbed('${uvEncode(x.url)}')">${x.name}</button>
      </div>
    `;
  });
}

/* --- CATEGORY TABS --- */
let categories=[...new Set(games.map(g=>g.cat))];
function loadCategories(){
  const c=document.getElementById("cat-tabs");
  c.innerHTML=`<div class="cat-btn active" onclick="filterCat('All')">All</div>`;
  categories.forEach(cat=>c.innerHTML+=`<div class="cat-btn" onclick="filterCat('${cat}')">${cat}</div>`);
}
function filterCat(cat){
  document.querySelectorAll(".cat-btn").forEach(e=>e.classList.remove("active"));
  if(cat==="All") document.querySelector(".cat-btn").classList.add("active");
  else [...document.querySelectorAll(".cat-btn")].find(x=>x.textContent===cat).classList.add("active");

  const g=document.getElementById("game-row");
  g.innerHTML="";
  games.filter(x=>cat==="All"||x.cat===cat).forEach(x=>{
    g.innerHTML+=`
      <div class="card">
        <div class="fav-star ${isFav(x.name)?"active":""}" onclick="event.stopPropagation();toggleFav('${x.name}')">‚òÖ</div>
        <img src="${x.img}">
        <button onclick="openEmbed('${uvEncode(x.url)}')">${x.name}</button>
      </div>
    `;
  });
}

/* --- EMBED VIEWER --- */
function openEmbed(url){
  const c=document.getElementById("embed-container");
  const f=document.getElementById("embed-frame");
  const s=document.getElementById("spinner");
  c.style.display="block"; s.style.display="block"; f.onload=()=>s.style.display="none";
  f.src=url;
}
document.addEventListener("keydown",e=>{
  if(e.key==="Escape"){ document.getElementById("embed-container").style.display="none"; document.getElementById("embed-frame").src=""; }
  if(e.key==="F") document.getElementById("embed-frame").requestFullscreen();
  if(e.key==="Q") panic();
});

/* --- SEARCH --- */
document.getElementById("search").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  document.querySelectorAll("#game-row .card").forEach(c=>{
    c.style.display=c.innerText.toLowerCase().includes(q)?"flex":"none";
  });
});

/* --- THEME --- */
function toggleTheme(){
  document.body.classList.toggle("light");
  localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
}
if(localStorage.getItem("theme")==="light") document.body.classList.add("light");

/* --- PANIC --- */
function panic(){ location.href="https://classroom.google.com"; }

/* --- INIT --- */
loadDownloads();
loadGames();
loadFavorites();
loadCategories();
if(profile.username){ document.getElementById("username").value=profile.username; }
if(profile.bio){ document.getElementById("bio").value=profile.bio; }

</script>
</body>
</html>
